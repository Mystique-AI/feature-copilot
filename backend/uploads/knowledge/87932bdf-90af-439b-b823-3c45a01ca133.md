# Mystique Auth Service

## Overview
A FastAPI-based authentication and authorization service that handles user authentication via OAuth providers (Google, Microsoft), token management, user registration, and domain management.

## Application Type
- **Type**: Backend API Service
- **Framework**: FastAPI
- **Database**: PostgreSQL (with Alembic migrations)
- **Security**: OAuth 2.0, JWT tokens, RSA encryption

## Features

### User Authentication (`/user`)
| Endpoint | Method | Feature | Description | Role |
|----------|--------|---------|-------------|------|
| `/login/oauth` | POST | OAuth Login | Authenticate via Google or Microsoft using access token | All Users |
| `/refresh_token` | POST | Token Refresh | Refresh access token using refresh token from cookies | All Users |
| `/logout` | POST | Logout | Invalidate refresh token and logout user | Authenticated Users |
| `/get_details` | GET | Get User Details | Retrieve user details from access token | Authenticated Users |
| `/get_activity` | POST | User Activity | Get paginated list of user activities | Authenticated Users |
| `/register-user` | POST | User Registration | Register new user in auth database | Internal |
| `/add-invited-users` | POST | Add Invited Users | Add users who were invited to a team | Authenticated Users |
| `/profile` | GET | User Profile | Get current user's profile details | Authenticated Users |

### Domain Management (`/domain`)
| Endpoint | Method | Feature | Description | Role |
|----------|--------|---------|-------------|------|
| `/add-domain` | POST | Add Domain | Register a new domain for multi-tenancy | Internal |

## Technical Components
- **UserService**: Core user authentication and management logic
- **DomainService**: Domain management for multi-tenant architecture
- **RSAService**: RSA encryption/decryption for secure token handling
- **JWT Token Management**: Access and refresh token generation/validation

## Security Features
- HTTP-only cookies for refresh tokens
- RSA-encrypted token transmission
- OAuth 2.0 integration with Google and Microsoft
- Bearer token authentication

## Database Models
- Users
- Domains
- User Activities
- Refresh Tokens

## Middleware
- Authentication middleware
- CORS handling
- Request logging
